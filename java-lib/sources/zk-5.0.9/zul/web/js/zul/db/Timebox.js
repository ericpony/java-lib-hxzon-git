(function(){var a="ahKHksmz",g=1,e=2,f=3,c=4,l=5,d=6,i=7;function j(x,p){var t=[],w=x._localizedSymbols?x._localizedSymbols.APM:zk.APM;for(var s=0,q=p.length;s<q;s++){var v=p.charAt(s);switch(v){case"a":var u=w[0].length;t.push(new zul.inp.AMPMHandler([s,s+u-1],f,x));break;case"K":var m=s,r=p.charAt(s+1)=="K"?++s:s;t.push(new zul.inp.HourHandler2([m,r],i));break;case"h":var m=s,r=p.charAt(s+1)=="h"?++s:s;t.push(new zul.inp.HourHandler([m,r],d));break;case"H":var m=s,r=p.charAt(s+1)=="H"?++s:s;t.push(new zul.inp.HourInDayHandler([m,r],c));break;case"k":var m=s,r=p.charAt(s+1)=="k"?++s:s;t.push(new zul.inp.HourInDayHandler2([m,r],l));break;case"m":var m=s,r=p.charAt(s+1)=="m"?++s:s;t.push(new zul.inp.MinuteHandler([m,r],g));break;case"s":var m=s,r=p.charAt(s+1)=="s"?++s:s;t.push(new zul.inp.SecondHandler([m,r],e));break;case"z":t.push({index:[s,s],format:(function(y){return function(){return y}})(x._timezone)});break;default:var o=[],m=s,r=s;while((o.push(v))&&++r<q){v=p.charAt(r);if(a.indexOf(v)!=-1){r--;break}}t.push({index:[m,r],format:(function(y){return function(){return y}})(o.join(""))});s=r}}for(var n,s=0,q=t.length;s<q;s++){if(t[s].type==f){n=t[s].index[1]-t[s].index[0];if(!n){break}}else{if(n){t[s].index[0]+=n;t[s].index[1]+=n}}}x._fmthdler=t}function b(B,r){var u=B.getInputNode(),m=zk(u).getSelectionRange(),x=m[0],w=m[1],v=B._fmthdler,s=v.$indexOf(r),A=[],o=r,q=true,z,t,y,n,p;do{y=o.index[0];n=o.index[1]+1;if(o.type&&(p=o.isSingleLength())){o._doShift(B,p);w--}if(n>=w&&o.type){t=w-y;while(t-->0){A.push(" ")}break}if(o.type){z=q?x:y;q=false;continue}t=y-z;while(t-->0){A.push(" ")}A.push(o.format())}while(o=v[++s]);return A.join("")}function h(t){var s=t.getInputNode().value,m=0,q,p;for(var o=0,r=t._fmthdler,n=r.length;o<n;o++){q=r[o];if(o==n-1){m+=q.format().length}else{m+=(q.type?q.getText(s):q.format()).length}if(q.type){p=q}}return(p.digits==1)?++m:m}var k={};zul.db.Timebox=zk.$extends(zul.inp.FormatWidget,{_buttonVisible:true,_format:"HH:mm",_timezone:"",$init:function(){this.$supers("$init",arguments);j(this,this._format)},$define:{timezone:function(m){j(this,this._format)},buttonVisible:function(m){var q=this.$n("btn"),o=this.getZclass();if(q){if(!this.inRoundedMold()){if(!this._inplace||!m){jq(q)[m?"show":"hide"]()}else{q.style.display=""}jq(this.getInputNode())[m?"removeClass":"addClass"](o+"-right-edge")}else{var p=m?"removeClass":"addClass";jq(q)[p](o+"-btn-right-edge");if(zk.ie6_){jq(q)[p](o+(this._readonly?"-btn-right-edge-readonly":"-btn-right-edge"));if(jq(this.getInputNode()).hasClass(o+"-text-invalid")){jq(q)[p](o+"-btn-right-edge-invalid")}}}this.onSize()}},localizedSymbols:[function(m){if(m){if(!k[m[0]]){k[m[0]]=m[1]}return k[m[0]]}return m}]},setFormat:function(m){m=m?m.replace(/\'/g,""):m;j(this,m);this.$supers("setFormat",arguments)},coerceToString_:function(o){if(!this._changed&&!o&&arguments.length){return""}var n=[],q,t,s;for(var p=0,r=this._fmthdler,m=r.length;p<m;p++){q=r[p];t=q.format(o);n.push(t);if(q.type&&(s=q.isSingleLength())!==false&&(s+=t.length-1)){q._doShift(this,s)}}return n.join("")},coerceFromString_:function(m){if(!m){return null}var o=zUtl.today(this._format),t,s,u,n=[],v=0;o.setSeconds(0);o.setMilliseconds(0);for(var q=0,r=this._fmthdler,p=r.length;q<p;q++){if(r[q].type==f){t=true;s=r[q].unformat(o,m);if(!r[q].getText(m).trim().length){v++}}else{if(r[q].type){n.push(r[q]);if(!r[q].getText(m).trim().length){v++}}}}if(n.length==(t?--v:v)){this._changed=false;return}for(var q=0,p=n.length;q<p;q++){if(!t&&(n[q].type==d||n[q].type==i)){s=true}o=n[q].unformat(o,m,s)}return o},getZclass:function(){var m=this._zclass;return m!=null?m:"z-timebox"+(this.inRoundedMold()?"-rounded":"")},onSize:function(){var m=this.getWidth(),n=this.getInputNode();if(!m||m.indexOf("%")!=-1){n.style.width=""}if(n&&this._value&&!n.value){n.value=this.coerceToString_(this._value)}this.syncWidth()},onHide:zul.inp.Textbox.onHide,validate:zul.inp.Intbox.validate,doClick_:function(m){if(m.domTarget==this.getInputNode()){this._doCheckPos()}this.$supers("doClick_",arguments)},doKeyPress_:function(m){if(zk.opera&&m.keyCode!=9){m.stop();return}this.$supers("doKeyPress_",arguments)},doKeyDown_:function(m){var o=this.getInputNode();if(o.disabled||o.readOnly){return}var n=m.keyCode;switch(n){case 48:case 96:case 49:case 97:case 50:case 98:case 51:case 99:case 52:case 100:case 53:case 101:case 54:case 102:case 55:case 103:case 56:case 104:case 57:case 105:n=n-(n>=96?96:48);this._doType(n);m.stop();return;case 35:this.lastPos=o.value.length;return;case 36:this.lastPos=0;return;case 37:if(this.lastPos>0){this.lastPos--}return;case 39:if(this.lastPos<o.value.length){this.lastPos++}return;case 38:this._doUp();m.stop();return;case 40:this._doDown();m.stop();return;case 46:this._doDel();m.stop();return;case 8:this._doBack();m.stop();return;case 9:break;case 13:case 27:break;default:if(!(n>=112&&n<=123)&&!m.ctrlKey&&!m.altKey){m.stop()}}this.$supers("doKeyDown_",arguments)},_dodropbtnup:function(m){var n=this.getZclass();jq(this._currentbtn).removeClass(n+"-btn-clk");if(!this.inRoundedMold()){jq(this._currentbtn).removeClass(n+"-btn-up-clk");jq(this._currentbtn).removeClass(n+"-btn-down-clk")}this.domUnlisten_(document.body,"onZMouseup","_dodropbtnup");this._currentbtn=null},_btnDown:function(n){var p=this.inRoundedMold();if(p&&!this._buttonVisible){return}var q;if(!(q=this.getInputNode())||q.disabled){return}var o=this.$n("btn"),t=this.getZclass();if(this._currentbtn){this._dodropbtnup(n)}jq(o).addClass(t+"-btn-clk");this.domListen_(document.body,"onZMouseup","_dodropbtnup");this._currentbtn=o;if(!q.value){q.value=this.coerceToString_()}this._lastPos=this._getPos();var r=zk(o).revisedOffset(),m=(n.pageY-r[1])<o.offsetHeight/2;if(m){this._doUp();this._startAutoIncProc(true)}else{this._doDown();this._startAutoIncProc(false)}var s=p?"":m?"-up":"-down";if((o=this.$n("btn"+s))&&!p){jq(o).addClass(t+"-btn"+s+"-clk");this._currentbtn=o}this._changed=true;zk.Widget.mimicMouseDown_(this);zk(q).focus();n.stop()},_btnUp:function(m){if(this.inRoundedMold()&&!this._buttonVisible){return}var n=this.getInputNode();if(n.disabled||zk.dragging){return}if(zk.opera){zk(n).focus()}this._onChanging();this._stopAutoIncProc();if((zk.ie||zk.safari)&&this._lastPos){zk(n).setSelectionRange(this._lastPos,this._lastPos)}},_btnOut:function(m){if(this.inRoundedMold()&&!this._buttonVisible){return}var n=this.getInputNode();if(!n||n.disabled||zk.dragging){return}jq(this.$n("btn")).removeClass(this.getZclass()+"-btn-over");this._stopAutoIncProc()},_btnOver:function(m){if(this.inRoundedMold()&&!this._buttonVisible){return}if(this.getInputNode()&&!this.getInputNode().disabled&&!zk.dragging){jq(this.$n("btn")).addClass(this.getZclass()+"-btn-over")}},_getPos:function(){return zk(this.getInputNode()).getSelectionRange()[0]},_doCheckPos:function(){this.lastPos=this._getPos()},_doUp:function(){this._changed=true;this.getTimeHandler().increase(this,1);this._onChanging()},_doDown:function(){this._changed=true;this.getTimeHandler().increase(this,-1);this._onChanging()},_doBack:function(){this._changed=true;this.getTimeHandler().deleteTime(this,true)},_doDel:function(){this._changed=true;this.getTimeHandler().deleteTime(this,false)},_doType:function(m){this._changed=true;this.getTimeHandler().addTime(this,m)},getTimeHandler:function(){var q=zk(this.getInputNode()).getSelectionRange(),s=q[0],o=q[1];var n;for(var p=0,r=this._fmthdler,m=r.length;p<m;p++){if(!r[p].type){continue}if(r[p].index[0]<=s){n=r[p];if(r[p].index[1]+1>=o){return r[p]}}}return n||this._fmthdler[0]},getNextTimeHandler:function(o){var p=this._fmthdler,n=p.$indexOf(o),m;while((m=p[++n])&&(!m.type||m.type==f)){}return m},_startAutoIncProc:function(m){if(this.timerId){clearInterval(this.timerId)}var n=this,o=m?"_doUp":"_doDown";this.timerId=setInterval(function(){if((zk.ie||zk.safari)&&n._lastPos){zk(n.getInputNode()).setSelectionRange(n._lastPos,n._lastPos)}n[o]()},300)},_stopAutoIncProc:function(){if(this.timerId){clearTimeout(this.timerId)}this.currentStep=this.defaultStep;this.timerId=null},syncWidth:function(){zul.inp.RoundUtl.syncWidth(this,this.$n("btn"))},doFocus_:function(m){var q=this.$n(),p=this.getInputNode(),o=zk(p).getSelectionRange();if(this._inplace){q.style.width=jq.px0(zk(q).revisedWidth(q.offsetWidth))}this.$supers("doFocus_",arguments);if(!p.value){p.value=this.coerceToString_()}this._doCheckPos();if(o[0]!==o[1]){zk(p).setSelectionRange(o[0],o[1]);this.lastPos=o[1]}if(this._inplace){if(jq(q).hasClass(this.getInplaceCSS())){jq(q).removeClass(this.getInplaceCSS());this.onSize()}}},doBlur_:function(m){var o=this.$n();if(this._inplace&&this._inplaceout){o.style.width=jq.px0(zk(o).revisedWidth(o.offsetWidth))}if(!this._value&&!this._changed){this.getInputNode().value=this._lastRawValVld=""}this.$supers("doBlur_",arguments);if(this._inplace&&this._inplaceout){jq(o).addClass(this.getInplaceCSS());this.onSize();o.style.width=this.getWidth()||""}},afterKeyDown_:function(m,n){if(!n&&this._inplace){jq(this.$n()).toggleClass(this.getInplaceCSS(),m.keyCode==13?null:false)}return this.$supers("afterKeyDown_",arguments)},bind_:function(){this.$supers(zul.db.Timebox,"bind_",arguments);var m,n=this.getInputNode();if(this._inplace){jq(n).addClass(this.getInplaceCSS())}if(m=this.$n("btn")){this.domListen_(m,"onZMouseDown","_btnDown").domListen_(m,"onZMouseUp","_btnUp").domListen_(m,"onMouseOut","_btnOut").domListen_(m,"onMouseOver","_btnOver")}zWatch.listen({onSize:this})},unbind_:function(){if(this.timerId){clearTimeout(this.timerId);this.timerId=null}zWatch.unlisten({onSize:this});var m=this.$n("btn");if(m){this.domUnlisten_(m,"onZMouseDown","_btnDown").domUnlisten_(m,"onZMouseUp","_btnUp").domUnlisten_(m,"onMouseOut","_btnOut").domUnlisten_(m,"onMouseOver","_btnOver")}this._changed=false;this.$supers(zul.db.Timebox,"unbind_",arguments)}});zul.inp.TimeHandler=zk.$extends(zk.Object,{maxsize:59,minsize:0,digits:2,$init:function(m,n,o){this.index=m;this.type=n;if(m[0]==m[1]){this.digits=1}this.wgt=o},format:function(m){return"00"},unformat:function(m,n){return m},increase:function(v,q){var s=v.getInputNode(),n=this.index[0],p=this.index[1]+1,o=s.value,u=this.getText(o),m=this.isSingleLength()!==false,r;u=zk.parseInt(m?u:u.replace(/ /g,"0"))+q;var t=this.maxsize+1;if(u<this.minsize){u=this.maxsize;r=1}else{if(u>=t){u=this.minsize;r=-1}else{if(m){r=(q>0)?(u==10)?1:0:(u==9)?-1:0}}}if(u<10&&!m){u="0"+u}s.value=o.substring(0,n)+u+o.substring(p);if(m&&r){this._doShift(v,r);p+=r}zk(s).setSelectionRange(n,p)},deleteTime:function(z,s){var v=z.getInputNode(),o=zk(v).getSelectionRange(),x=o[0],p=v.value,n=h(z);if(p.length>n){p=v.value=p.substr(0,n);o=[Math.min(o[0],n),Math.min(o[1],n)];x=o[0]}if(x!=o[1]){v.value=p.substring(0,x)+b(z,this)+p.substring(o[1])}else{var w=z._fmthdler,t=w.$indexOf(this),u=s?-1:1,m=s?0:1,y=s?1:0,q,r;if(x==this.index[m]+m){if(q=w[t+u*2]){x=q.index[y]+y+u}}else{x+=u;q=this}if(q){r=q.isSingleLength();v.value=p.substring(0,(y+=x)-1)+(r?"":" ")+p.substring(y);if(r){q._doShift(z,r)}}if(r&&!s){x--}}zk(v).setSelectionRange(x,x)},_addNextTime:function(q,o){var p=q.getInputNode(),n,m;if(m=q.getNextTimeHandler(this)){n=m.index[0];zk(p).setSelectionRange(n,Math.max(n,zk(p).getSelectionRange()[1]));m.addTime(q,o)}},addTime:function(y,r){var u=y.getInputNode(),n=zk(u).getSelectionRange(),o=u.value,v=n[0],m=h(y),p=this.isSingleLength();if(o.length>m){o=u.value=o.substr(0,m);n=[Math.min(n[0],m),Math.min(n[1],m)];v=n[0]}if(v==m){return}if(v==this.index[0]){var w=this.getText(o).substring((p===0)?0:1).trim(),q;if(!w.length){w="0"}if((q=zk.parseInt(r+w))>this.maxsize){if(p!==0){o=u.value=o.substring(0,v)+(p?"0":"00")+o.substring(v+2);if(!p){v++}zk(u).setSelectionRange(v,Math.max(n[1],v));n=zk(u).getSelectionRange()}if(p){this._doShift(y,p)}}}else{if(v==(this.index[1]+1)){var q;if(p!==false){var w=this.getText(o);if((q=zk.parseInt(w+r))<=this.maxsize){if(q&&q<10){v--}else{if(q||p){o=u.value=o.substring(0,(v+p))+(p?"":"0")+o.substring(v);if(q){this._doShift(y,1)}else{zk(u).setSelectionRange(v,Math.max(n[1],v));if(p){this._doShift(y,p)}}}}}}if(!q||q>this.maxsize){this._addNextTime(y,r);return}}}if(v!=n[1]){var x=b(y,this),t;if(p!==false&&(t=v-this.index[1])){this._doShift(y,t)}u.value=o.substring(0,v++)+r+x.substring(t?0:1)+o.substring(n[1])}else{u.value=o.substring(0,v)+r+o.substring(++v)}y.lastPos=v;zk(u).setSelectionRange(v,v)},getText:function(n){var o=this.index[0],m=this.index[1]+1;return n.substring(o,m)},_doShift:function(q,m){var p=q._fmthdler,o=p.$indexOf(this),n;this.index[1]+=m;while(n=p[++o]){n.index[0]+=m;n.index[1]+=m}},isSingleLength:function(){return this.digits==1&&(this.index[0]-this.index[1])}});zul.inp.HourInDayHandler=zk.$extends(zul.inp.TimeHandler,{maxsize:23,minsize:0,format:function(m){var n=this.digits==1;if(!m){return n?"0":"00"}else{var o=m.getHours();if(!n&&o<10){o="0"+o}return o.toString()}},unformat:function(m,n){m.setHours(zk.parseInt(this.getText(n)));return m}});zul.inp.HourInDayHandler2=zk.$extends(zul.inp.TimeHandler,{maxsize:24,minsize:1,format:function(m){if(!m){return"24"}else{var n=m.getHours();if(n==0){n="24"}else{if(this.digits==2&&n<10){n="0"+n}}return n.toString()}},unformat:function(n,o){var m=zk.parseInt(this.getText(o));if(m==24){m=0}n.setHours(m);return n}});zul.inp.HourHandler=zk.$extends(zul.inp.TimeHandler,{maxsize:12,minsize:1,format:function(m){if(!m){return"12"}else{var n=m.getHours();n=(n%12);if(n==0){n="12"}else{if(this.digits==2&&n<10){n="0"+n}}return n.toString()}},unformat:function(n,p,o){var m=zk.parseInt(this.getText(p));if(m==12){m=0}n.setHours(o?m:m+12);return n}});zul.inp.HourHandler2=zk.$extends(zul.inp.TimeHandler,{maxsize:11,minsize:0,format:function(m){var n=this.digits==1;if(!m){return n?"0":"00"}else{var o=m.getHours();o=(o%12);if(!n&&o<10){o="0"+o}return o.toString()}},unformat:function(n,p,o){var m=zk.parseInt(this.getText(p));n.setHours(o?m:m+12);return n}});zul.inp.MinuteHandler=zk.$extends(zul.inp.TimeHandler,{format:function(o){var p=this.digits==1;if(!o){return p?"0":"00"}else{var n=o.getMinutes();if(!p&&n<10){n="0"+n}return n.toString()}},unformat:function(m,n){m.setMinutes(zk.parseInt(this.getText(n)));return m}});zul.inp.SecondHandler=zk.$extends(zul.inp.TimeHandler,{format:function(m){var n=this.digits==1;if(!m){return n?"0":"00"}else{var o=m.getSeconds();if(!n&&o<10){o="0"+o}return o.toString()}},unformat:function(m,n){m.setSeconds(zk.parseInt(this.getText(n)));return m}});zul.inp.AMPMHandler=zk.$extends(zul.inp.TimeHandler,{format:function(m){var o=this.wgt._localizedSymbols?this.wgt._localizedSymbols.APM:zk.APM;if(!m){return o[0]}var n=m.getHours();return o[n<12?0:1]},unformat:function(m,p){var o=this.getText(p).trim(),n=this.wgt._localizedSymbols?this.wgt._localizedSymbols.APM:zk.APM;return(o.length==n[0].length)?n[0]==o:true},addTime:function(s,n){var o=s.getInputNode(),t=this.index[0],m=this.index[1]+1,r=o.value,q=r.substring(t,m),p=s._localizedSymbols?s._localizedSymbols.APM:zk.APM;if(q!=p[0]&&q!=p[1]){q=p[0];o.value=r.substring(0,t)+q+r.substring(m)}this._addNextTime(s,n)},deleteTime:function(x,r){var s=x.getInputNode(),n=zk(s).getSelectionRange(),u=n[0],v=n[1],m=this.index[0],p=this.index[1]+1,o=s.value;if(v-u>p-m){return this.$supers("deleteTime",arguments)}var w=[""];for(var q=p-m;q>0;q--){w.push(" ")}s.value=o.substring(0,m)+w.join("")+o.substring(p);zk(s).setSelectionRange(m,m)},increase:function(s,m){var o=s.getInputNode(),t=this.index[0],n=this.index[1]+1,r=o.value,q=r.substring(t,n),p=s._localizedSymbols?s._localizedSymbols.APM:zk.APM;q=p[0]==q?p[1]:p[0];o.value=r.substring(0,t)+q+r.substring(n);zk(o).setSelectionRange(t,n)}})})();