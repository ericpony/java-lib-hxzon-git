(function(){function b(e){var d=zk.Widget.$(e)._colspan;return d?d:1}function c(o,h,i){for(var e=0,d=0,m=o.length;e<m;++e){var f=d+b(zk.Widget.$(o[e]));if(h>=d&&f>h){for(;e<m&&d<i;++e,d=f){var n=o[e],f=d+b(n),l=h-d,g=f-i;l=(l>0?l:0)+(g>0?g:0);if(l){n.style.width=""}else{n.style.width="0px"}}for(;e<m;++e){var n=o[e];if(parseInt(n.style.width)!=0){break}n.style.width=""}return}d=f}}function a(m){var l=m.parent,j;if(!(j=l.ebdfaker)&&(j=l.ebodyrows[0])){j=j.$n()}if(j){var f=0;for(var g=m._columns,e=j.firstChild;e&&g--;e=e.nextSibling){f+=e.offsetWidth}m.$n("cave").style.width=jq.px0(f);var k=m.$n("scrollX"),d=l.$n("body").offsetWidth;d-=f;k.style.width=jq.px0(d);var h=j.childNodes.length-m._columns-2;k.firstChild.style.width=jq.px0(d+50*h);m.syncScroll()}}zul.mesh.Frozen=zk.$extends(zul.Widget,{_start:0,$define:{columns:[function(d){return d<0?0:d},function(d){if(this._columns){if(this.desktop){this.onSize();this.syncScroll()}}else{this.rerender()}}],start:function(){this.syncScroll()}},syncScroll:function(){var d=this.$n("scrollX");if(d){d.scrollLeft=this._start*50}},getZclass:function(){return this._zclass==null?"z-frozen":this._zclass},onSize:function(){if(!this._columns){return}var d=this;setTimeout(function(){a(d)})},_onScroll:function(d){if(!d.data||!zk.currentFocus){return}var h,e,i,g=this,f=function(){if(zk.currentFocus&&(i=h.getFocusCell(zk.currentFocus.$n()))&&(e=i.cellIndex-g._columns)>=0){g.setStart(e);h.ebody.scrollLeft=0}};if(h=this.parent){if(zk.ie){setTimeout(f,0)}else{f()}}d.stop()},bind_:function(){this.$supers(zul.mesh.Frozen,"bind_",arguments);zWatch.listen({onSize:this});var d=this.$n("scrollX"),f=this.parent,e=f.$n("body");this.$n().style.height=this.$n("cave").style.height=d.style.height=d.firstChild.style.height=jq.px0(jq.scrollbarWidth());f.listen({onScroll:this.proxy(this._onScroll)},-1000);this.domListen_(d,"onScroll");if(e){jq(e).addClass("z-word-nowrap").css("overflow-x","hidden");f._currentLeft=0}},unbind_:function(){zWatch.unlisten({onSize:this});var f,d,e;if(f=this.parent){f.unlisten({onScroll:this.proxy(this._onScroll)});if(d=f.$n("body")){jq(d).removeClass("z-word-nowrap").css("overflow-x","")}if(f.head&&(e=f.head.$n("hdfakerflex"))){e.style.width=""}}if((f=this.parent)&&(f=f.$n("body"))){jq(f).removeClass("z-word-nowrap").css("overflow-x","")}this.$supers(zul.mesh.Frozen,"unbind_",arguments)},beforeParentChanged_:function(d){if(this._lastScale){this._doScrollNow(0)}this.$supers("beforeParentChanged_",arguments)},_doScroll:function(e){var d=this.$n("scrollX"),f=Math.ceil(d.scrollLeft/50);if(this._lastScale==f){return}this._lastScale=f;this._doScrollNow(f);this.smartUpdate("start",f);this._start=f},_syncFrozen:function(){this._scrlcnt=(this._scrlcnt||0)+1;var d=this;return setTimeout(function(){var e;if(!--d._scrlcnt&&(e=d._start)){d._doScrollNow(e,true)}},10)},_doScrollNow:function(l,e){var w=this.desktop?this.$n("cave").offsetWidth:null,d=this.parent,A=l,p=d.ebodyrows;if(d.head){for(var q,v=d.head.firstChild.$n("hdfaker");v;v=v.nextSibling){if(v.style.width.indexOf("px")==-1){var t=v.style.width=jq.px0(v.offsetWidth),o=zk.Widget.$(v);if(!o.$instanceof(zul.mesh.HeadWidget)){if((q=o.$n("bdfaker"))){q.style.width=t}if((q=o.$n("ftfaker"))){q.style.width=t}}}}var u=d.head.getChildAt(this._columns).$n(),x,D,G,z;for(var y,q,j=this._columns,m=d.head.nChildren-j,v=u;v;v=v.nextSibling,j++,m--){x=(D=zk.Widget.$(v))&&D.isVisible();G=false;if(A--<=0){if(e||parseInt(v.style.width)==0){z=D._origWd||v.style.width||jq.px0(jq(v).outerWidth());D._origWd=null;G=true}}else{if(e||parseInt(v.style.width)!=0){q=jq("#"+v.id+"-hdfaker")[0];D._origWd=D._origWd||q.style.width||jq.px0(jq(q).outerWidth());z="0px";G=true}}if(e||G){v.style.width=z;if((q=jq("#"+v.id+"-hdfaker")[0])){q.style.width=z}if((q=jq("#"+v.id+"-bdfaker")[0])&&x){q.style.width=z}if((q=jq("#"+v.id+"-ftfaker")[0])){q.style.width=z}if(d.foot){var E=d.efoottbl;if(E){var k=E.tBodies;if(k){k[k.length-1].rows[0].cells[j].style.width=z}}}}}for(var f=u.parentNode,g=f.parentNode.rows,B=g.length,s;B--;){if((s=g[B])!=f){c(s.cells,this._columns,this._columns+l)}}if(w){for(var v=d.head.getChildAt(this._columns+l).$n("hdfaker");v;v=v.nextSibling){w+=zk.parseInt(v.style.width)}}}else{if(!p||!p.length){return}else{for(var j=this._columns,F=p[0].firstChild;F;F=F.nextSibling){if(F.style.width.indexOf("px")==-1){F.style.width=jq.px0(zk(F).revisedWidth(F.offsetWidth))}}for(var h=p[0],y,j=this._columns,C=h.childNodes.length;j<C;j++){y=A--<=0?"":"none";for(var s=h;s;s=s.nextSibling){s.cells[j].style.display=y}}for(var F=p[0].cells[this._columns+l];F;F=F.nextSibling){w+=zk.parseInt(F.style.width)}}}w=w?jq.px0(w):"";if(d.eheadtbl){d.eheadtbl.style.width=w}if(d.ebodytbl){d.ebodytbl.style.width=w}if(d.efoottbl){d.efoottbl.style.width=w}d._restoreFocus()}})})();