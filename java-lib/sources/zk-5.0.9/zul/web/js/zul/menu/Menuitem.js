(function(){function b(d){zWatch.listen(zk.ie7_?{onSize:d}:{onShow:d});var c;if(c=d._upload){d._uplder=new zul.Upload(d,d._getUploadRef(),c)}}function a(d){var c;if(c=d._uplder){zWatch.unlisten(zk.ie7_?{onSize:d}:{onShow:d});d._uplder=null;c.destroy()}}(zul.menu.Menuitem=zk.$extends(zul.LabelImageWidget,{_value:"",$define:{checkmark:_zkf=function(){this.rerender()},disabled:_zkf,href:_zkf,value:null,checked:function(d){if(d){this._checkmark=d}var f=this.$n("a");if(f&&!this.isTopmost()&&!this.getImage()){var e=this.getZclass(),c=jq(f);c.removeClass(e+"-cnt-ck").removeClass(e+"-cnt-unck");if(this._checkmark){c.addClass(e+(d?"-cnt-ck":"-cnt-unck"))}}},autocheck:null,target:function(d){var c=this.$n("a");if(c){if(this.isTopmost()){c=c.parentNode}c.target=this._target}},autodisable:null,upload:function(c){var d=this.$n();if(d){a(this);if(c&&c!="false"){b(this)}}}},isTopmost:function(){return this._topmost},beforeParentChanged_:function(c){this._topmost=c&&!(c.$instanceof(zul.menu.Menupopup));this.$supers("beforeParentChanged_",arguments)},domClass_:function(e){var d=this.$supers("domClass_",arguments);if(!e||!e.zclass){var c=this.isDisabled()?this.getZclass()+"-disd":"";if(c){d+=(d?" ":"")+c}}return d},getZclass:function(){return this._zclass==null?"z-menu-item":this._zclass},domContent_:function(){var d=zUtl.encodeXML(this.getLabel()),c='<span class="'+this.getZclass()+'-img"'+(this._image?' style="background-image:url('+this._image+')"':"")+"></span>";return d?c+" "+d:c},domStyle_:function(d){var c=this.$supers("domStyle_",arguments);return this.isTopmost()?c+"padding-left:4px;padding-right:4px;":c},getMenubar:zul.menu.Menu.prototype.getMenubar,bind_:function(){this.$supers(zul.menu.Menuitem,"bind_",arguments);if(!this.isDisabled()){if(this.isTopmost()){var c=this.$n("a");this.domListen_(c,"onFocus","doFocus_").domListen_(c,"onBlur","doBlur_")}if(this._upload){b(this)}}},unbind_:function(){if(!this.isDisabled()){if(this._upload){a(this)}if(this.isTopmost()){var c=this.$n("a");this.domUnlisten_(c,"onFocus","doFocus_").domUnlisten_(c,"onBlur","doBlur_")}}this.$supers(zul.menu.Menuitem,"unbind_",arguments)},doClick_:function(c){if(this._disabled){c.stop()}else{if(!this._canActivate(c)){return}if(!this._upload){zul.wgt.ADBS.autodisable(this)}var d=this.isTopmost(),f=this.$n("a");if(d){jq(f).removeClass(this.getZclass()+"-body-over");f=f.parentNode}if(f.href.startsWith("javascript:")){if(this.isAutocheck()){this.setChecked(!this.isChecked());this.fire("onCheck",this.isChecked())}this.fireX(c)}else{if(zk.ie&&d&&this.$n().id!=f.id){zUtl.go(f.href,{target:f.target})}if(zk.gecko3&&d&&this.$n().id!=f.id){zUtl.go(f.href,{target:f.target});c.stop()}}if(!d){for(var g=this.parent;g;g=g.parent){if(g.$instanceof(zul.menu.Menupopup)){if(!g.isOpen()||this._uplder){break}this._updateHoverImage();g.close({sendOnOpen:true})}else{if(!g.$instanceof(zul.menu.Menu)){break}else{g._updateHoverImage()}}}}var e;if(zk.safari&&(e=this.getMenubar())&&e._autodrop){e._noFloatUp=true}this.$class._rmActive(this);this.$super("doClick_",c,true)}},_canActivate:function(c){return !this.isDisabled()&&(!zk.ie||!this.isTopmost()||this._uplder||jq.isAncestor(this.$n("a"),c.domTarget))},_getUploadRef:function(){return this.isTopmost()?this.$n():this.$n("a")},doMouseOver_:function(c){var d=this.getMenubar();if(d){d._bOver=true;d._noFloatUp=false}if(!this.$class._isActive(this)&&this._canActivate(c)){this.$class._addActive(this);if(zul.menu._nOpen||!this.isTopmost()){zWatch.fire("onFloatUp",this)}}this.$supers("doMouseOver_",arguments)},doMouseOut_:function(e){var f=this.getMenubar();if(f){f._bOver=false;f._closeOnOut()}if(!this.isDisabled()){var d=!zk.ie;if(!d){var j=this.$n("a"),h=zk(j).revisedOffset(),c=e.pageX,i=e.pageY,g=this.isTopmost()?1:0;d=c-g<=h[0]||c>h[0]+j.offsetWidth||i-g<=h[1]||i>h[1]+j.offsetHeight+(zk.ie?-1:0)}if(d){this.$class._rmActive(this)}}this.$supers("doMouseOut_",arguments)},deferRedrawHTML_:function(d){var c=this.isTopmost()?"td":"li";d.push("<",c,this.domAttrs_({domClass:1}),' class="z-renderdefer"></',c,">")},getImageNode:function(){if(!this._eimg&&(this._image||this._hoverImage)){var c=this.$n();if(c){this._eimg=this.$n("b")||this.$n("a").firstChild}}return this._eimg}},{_isActive:function(e){var d=e.isTopmost(),f=d?e.$n("a"):e.$n(),c=e.getZclass()+(d?"-body-over":"-over");return jq(f).hasClass(c)},_addActive:function(e){var d=e.isTopmost(),f=d?e.$n("a"):e.$n(),c=e.getZclass()+(d?"-body-over":"-over");jq(f).addClass(c);if(!d&&e.parent.parent.$instanceof(zul.menu.Menu)){this._addActive(e.parent.parent)}},_rmActive:function(e){var d=e.isTopmost(),f=d?e.$n("a"):e.$n(),c=e.getZclass()+(d?"-body-over":"-over");jq(f).removeClass(c)}})).prototype[zk.ie7_?"onSize":"onShow"]=function(){if(this._uplder){this._uplder.sync()}}})();