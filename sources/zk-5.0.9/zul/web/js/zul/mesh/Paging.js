(function(){function b(c){if(c.isBothPaging()){c.parent.rerender(0);return true}}function a(c){return(c.toString().search(/^[0-9]+$/)==0)}zul.mesh.Paging=zk.$extends(zul.Widget,{_pageSize:20,_totalSize:0,_pageCount:1,_activePage:0,_pageIncrement:10,$define:{totalSize:function(){this._updatePageNum();if(this._detailed){if(!b(this)){var c=this.$n("info");if(c){c.innerHTML=this.infoText_()}}}},pageIncrement:_zkf=function(){this.rerender(0)},detailed:_zkf,pageCount:_zkf,activePage:_zkf,pageSize:function(){this._updatePageNum()},autohide:function(){if(this._pageCount==1){this.rerender(0)}}},setStyle:function(){this.$supers("setStyle",arguments);b(this)},setSclass:function(){this.$supers("setSclass",arguments);b(this)},setWidth:function(){this.$supers("setWidth",arguments);b(this)},setHeight:function(){this.$supers("setHeight",arguments);b(this)},setLeft:function(){this.$supers("setLeft",arguments);b(this)},setTop:function(){this.$supers("setTop",arguments);b(this)},setTooltiptext:function(){this.$supers("setTooltiptext",arguments);b(this)},replaceHTML:function(){if(!b(this)){this.$supers("replaceHTML",arguments)}},isBothPaging:function(){return this.parent&&this.parent.getPagingPosition&&"both"==this.parent.getPagingPosition()},_updatePageNum:function(){var c=Math.floor((this._totalSize-1)/this._pageSize+1);if(c==0){c=1}if(c!=this._pageCount){this._pageCount=c;if(this._activePage>=this._pageCount){this._activePage=this._pageCount-1}if(this.desktop&&this.parent){if(!b(this)){this.rerender();if(this.parent.$instanceof(zul.mesh.MeshWidget)){var d=this.parent.$n();if(d&&d._lastsz){d._lastsz=null}this.parent.onSize()}}}}},infoText_:function(){var c=(this._activePage+1)*this._pageSize;return"[ "+(this._activePage*this._pageSize+1)+("os"!=this.getMold()?" - "+(c>this._totalSize?this._totalSize:c):"")+" / "+this._totalSize+" ]"},_infoTags:function(){if(this._totalSize==0){return""}var d=(this._activePage+1)*this._pageSize,c=[];c.push('<div id="',this.uuid,'-info" class="',this.getZclass(),'-info">',this.infoText_(),"</div>");return c.join("")},_innerTags:function(){var e=[];var h=Math.round(this._pageIncrement/2),f,d=this._activePage+h-1;if(d>=this._pageCount){d=this._pageCount-1;f=d-this._pageIncrement+1;if(f<0){f=0}}else{f=this._activePage-h;if(f<0){f=0}d=f+this._pageIncrement-1;if(d>=this._pageCount){d=this._pageCount-1}}var c=this.getZclass();if(this._activePage>0){if(f>0){this.appendAnchor(c,e,msgzul.FIRST,0)}this.appendAnchor(c,e,msgzul.PREV,this._activePage-1)}var g=this._activePage<this._pageCount-1;for(;f<=d;++f){if(f==this._activePage){this.appendAnchor(c,e,f+1,f,true)}else{this.appendAnchor(c,e,f+1,f)}}if(g){this.appendAnchor(c,e,msgzul.NEXT,this._activePage+1);if(d<this._pageCount-1){this.appendAnchor(c,e,msgzul.LAST,this._pageCount-1)}}if(this._detailed){e.push('<span id="',this.uuid,'-info">',this.infoText_(),"</span>")}return e.join("")},appendAnchor:function(g,d,c,i,e){var h=g+"-cnt"+(e?" "+g+"-seld":""),f=a(c);g+="-cnt"+(e?"-seld":"");if(f){d.push('<div class="',g,'-l"><div class="',g,'-r"><div class="',g,'-m">')}d.push('<a class="',h,'" href="javascript:;" onclick="zul.mesh.Paging.go(this,',i,')">',c,"</a>");if(f){d.push("</div></div></div>")}},_doMouseEvt:function(c){var d=this.getZclass()+"-cnt-l";jq(c.domTarget).parents("."+d)[c.name=="onMouseOver"?"addClass":"removeClass"](d+"-over")},getZclass:function(){var c="os"==this.getMold()?"-os":"";return this._zclass==null?"z-paging"+c:this._zclass},isVisible:function(){var c=this.$supers("isVisible",arguments);return c&&(this._pageCount>1||!this._autohide)},bind_:function(){this.$supers(zul.mesh.Paging,"bind_",arguments);if(this.getMold()=="os"){var n=jq(this.$n()).find("div a"),l=n.length;while(l-->0){this.domListen_(n[l],"onMouseOver","_doMouseEvt").domListen_(n[l],"onMouseOut","_doMouseEvt")}return}var c=this.uuid,m=jq.$$(c,"real"),d=this.getZclass(),h=this.$class;if(!this.$weave){for(var l=m.length;l--;){jq(m[l]).keydown(h._domKeyDown).blur(h._domBlur)}}for(var o=["first","prev","last","next"],f=o.length;f--;){var e=jq.$$(c,o[f]);for(var g=e.length;g--;){if(!this.$weave){jq(e[g]).mouseover(h._domMouseOver).mouseout(h._domMouseOut).bind("zmousedown",h._domMouseDown).click(h["_dom"+o[f]+"Click"])}if(this._pageCount==1){jq(e[g]).addClass(d+"-btn-disd")}else{if(o[f]=="first"||o[f]=="prev"){if(this._activePage==0){jq(e[g]).addClass(d+"-btn-disd")}}else{if(this._activePage==this._pageCount-1){jq(e[g]).addClass(d+"-btn-disd")}}}}}},unbind_:function(){if(this.getMold()!="os"){var c=this.uuid,l=jq.$$(c,"real"),g=this.$class;for(var h=l.length;h--;){jq(l[h]).unbind("keydown",g._domKeyDown).unbind("blur",g._domBlur)}for(var n=["first","prev","last","next"],e=n.length;e--;){var d=jq.$$(c,n[e]);for(var f=d.length;f--;){jq(d[f]).unbind("mouseover",g._domMouseOver).unbind("mouseout",g._domMouseOut).unbind("zmousedown",g._domMouseDown).unbind("click",g["_dom"+n[e]+"Click"])}}}else{var m=jq(this.$n()).find("div a"),h=m.length;while(h-->0){this.domUnlisten_(m[h],"onMouseOver","_doMouseEvt").domUnlisten_(m[h],"onMouseOut","_doMouseEvt")}}this.$supers(zul.mesh.Paging,"unbind_",arguments)}},{go:function(c,e){var d=zk.Widget.isInstance(c)?c:zk.Widget.$(c);if(d&&d.getActivePage()!=e){d.fire("onPaging",e)}},_domKeyDown:function(c){var e=c.target,f=zk.Widget.$(e);if(e.disabled||e.readOnly){return}var d=c.keyCode;switch(d){case 48:case 96:case 49:case 97:case 50:case 98:case 51:case 99:case 52:case 100:case 53:case 101:case 54:case 102:case 55:case 103:case 56:case 104:case 57:case 105:break;case 37:break;case 38:case 33:f.$class._increase(e,f,1);c.stop();break;case 39:break;case 40:case 34:f.$class._increase(e,f,-1);c.stop();break;case 36:f.$class.go(f,0);c.stop();break;case 35:f.$class.go(f,f._pageCount-1);c.stop();break;case 9:case 8:case 46:break;case 13:f.$class._increase(e,f,0);f.$class.go(f,e.value-1);c.stop();break;default:if(!(d>=112&&d<=123)&&!c.ctrlKey&&!c.altKey){c.stop()}}},_domBlur:function(c){var d=c.target,e=zk.Widget.$(d);if(d.disabled||d.readOnly){return}e.$class._increase(d,e,0);e.$class.go(e,d.value-1);c.stop()},_increase:function(c,f,e){var d=zk.parseInt(c.value);d+=e;if(d<1){d=1}else{if(d>f._pageCount){d=f._pageCount}}c.value=d},_domfirstClick:function(c){var j=zk.Widget.$(c),h=j.getZclass();if(j.getActivePage()!=0){j.$class.go(j,0);var g=j.uuid;for(var l=["first","prev"],d=l.length;d--;){for(var f=jq.$$(g,l[d]),e=f.length;e--;){jq(f[e]).addClass(h+"-btn-disd")}}}},_domprevClick:function(j){var m=zk.Widget.$(j),g=m.getActivePage(),d=m.getZclass();if(g>0){m.$class.go(m,g-1);if(g-1==0){var c=m.uuid;for(var l=["first","prev"],f=l.length;f--;){for(var e=jq.$$(c,l[f]),h=e.length;h--;){jq(e[h]).addClass(d+"-btn-disd")}}}}},_domnextClick:function(l){var n=zk.Widget.$(l),g=n.getActivePage(),j=n.getPageCount(),d=n.getZclass();if(g<j-1){n.$class.go(n,g+1);if(g+1==j-1){var c=n.uuid;for(var m=["last","next"],f=m.length;f--;){for(var e=jq.$$(c,m[f]),h=e.length;h--;){jq(e[h]).addClass(d+"-btn-disd")}}}}},_domlastClick:function(j){var m=zk.Widget.$(j),h=m.getPageCount(),d=m.getZclass();if(m.getActivePage()<h-1){m.$class.go(m,h-1);var c=m.uuid;for(var l=["last","next"],f=l.length;f--;){for(var e=jq.$$(c,l[f]),g=e.length;g--;){jq(e[g]).addClass(d+"-btn-disd")}}}},_domMouseOver:function(c){var e=c.target,d=jq(e).parents("table:first"),f=zk.Widget.$(e).getZclass();if(!d.hasClass(f+"-btn-disd")){d.addClass(f+"-btn-over")}},_domMouseOut:function(c){var e=c.target,d=jq(e).parents("table:first"),f=zk.Widget.$(e);if(!zk.ie||!jq.isAncestor(d[0],c.relatedTarget||c.toElement)){d.removeClass(f.getZclass()+"-btn-over")}},_domMouseDown:function(c){var e=c.target,d=jq(e).parents("table:first"),g=zk.Widget.$(e),f=g.getZclass();if(!d.hasClass(f+"-btn-disd")){d.addClass(f+"-btn-clk");g.$class._downbtn=d[0];jq(document).bind("zmouseup",g.$class._domMouseUp)}},_domMouseUp:function(c){if(zul.mesh.Paging._downbtn){var d=zk.Widget.$(zul.mesh.Paging._downbtn).getZclass();jq(zul.mesh.Paging._downbtn).removeClass(d+"-btn-clk")}zul.mesh.Paging._downbtn=null;jq(document).unbind("zmouseup",zul.mesh.Paging._domMouseUp)}})})();