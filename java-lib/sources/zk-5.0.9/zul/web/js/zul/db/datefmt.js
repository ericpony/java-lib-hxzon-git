(function(){function j(t,o){var w=[],z=o.indexOf("MMM"),v=o.indexOf("EE"),m=o.length,n=[],l=o.indexOf("a"),p=t.replace(/[^.]/g,"").length,y=o.replace(/[^.]/g,"").length;for(var s=0,q=0,r=t.length;q<r;s++,q++){var x=t.charAt(q),u=m>s?o.charAt(s):"";if(x.match(/\d/)){n.push(x)}else{if((z>=0&&z<=s)||(v>=0&&v<=s)||(l>-1&&l<=s)){if(x.match(/\w/)){n.push(x)}else{if(x.charCodeAt(0)<128&&(x.charCodeAt(0)!=46||p==y||u.charCodeAt(0)==46)){if(n.length){w.push(n.join(""));n=[]}}else{n.push(x)}}}else{if(n.length){if(t.charAt(q-1).match(/\d/)){while(u==o.charAt(s-1)&&u){u=o.charAt(++s)}}w.push(n.join(""));n=[]}else{if(x.match(/\w/)){return}}}}}if(n.length){w.push(n.join(""))}return w}function c(n,o,m,l){if(l<2){l=2}if(n&&n.length>l){o[m]=n.substring(l);return n.substring(0,l)}return n}function h(l){return parseInt(l,10)}function i(o,n){var m=""+o;for(var l=n-m.length;--l>=0;){m="0"+m}return m}function a(o,l){if(l.length){for(var n=o.length;n--;){var m=l.indexOf(o[n]);if(m>=0){l=l.substring(0,m)+l.substring(m+o[n].length)}}}return l}function d(m,l){return Math.round((new Date(m.getFullYear(),m.getMonth(),m.getDate())-l)/86400000)}function e(m,l){if(!l){l=new Date(m.getFullYear(),0,1)}return i(1+d(m,l))}function b(l){return l.getDate()}function f(n,l){if(!l){l=new Date(n.getFullYear(),0,1)}var m=l.getDay();if(m==7){m=0}return i(1+Math.floor((d(n,l)+m)/7))}function g(l){return f(l,new Date(l.getFullYear(),l.getMonth(),1))}function k(l){return i(1+Math.floor(d(l,new Date(l.getFullYear(),l.getMonth(),1))/7))}zk.fmt.Date={parseDate:function(r,A,I,E,Q){if(!A){A="yyyy/MM/dd"}E=E||zUtl.today(A);Q=Q||{DOW_1ST:zk.DOW_1ST,ERA:zk.ERA,YDELTA:zk.YDELTA,SDOW:zk.SDOW,S2DOW:zk.S2DOW,FDOW:zk.FDOW,SMON:zk.SMON,S2MON:zk.S2MON,FMON:zk.FMON,APM:zk.APM};var J=E.getFullYear(),M=E.getMonth(),V=E.getDate(),C,O=E.getHours(),W=E.getMinutes(),H=E.getSeconds(),B=E.getMilliseconds(),w=A.indexOf("a"),o=w>-1,x=o&&(A.indexOf("h")>-1||A.indexOf("K")>-1),K,U=j(r,A),X=!isNaN(r);if(!U||!U.length){return}for(var T=0,S=0,t=0,D=A.length;S<D;++S){var G=A.charAt(S);if((G>="a"&&G<="z")||(G>="A"&&G<="Z")){var z=1,R;for(R=S;++R<D;++z){if(A.charAt(R)!=G){break}}var n,P;if(R<D){var q=A.charAt(R);n=q=="y"||q=="M"||q=="d"||q=="E"}var v=X?U[0].substring(S-t,R-t):U[T++];switch(G){case"y":if(n){if(z<=3){z=2}if(v&&v.length>z){U[--T]=v.substring(z);v=v.substring(0,z)}}if(!isNaN(P=h(v))){J=Math.min(P,200000);if(J<100){J+=J>29?1900:2000}}break;case"M":var Y=v?v.toLowerCase():"",u=!isNaN(v);if(!Y){break}if(!u&&v){for(var F=Q.SMON.length,L;--F>=0;){var s=Q.SMON[F].toLowerCase();if(Y.startsWith(s)){v=Q.SMON[F];M=F;L=true;break}}if(L){break}}if(z==3&&v){if(n){v=c(v,U,--T,v.length)}if(isNaN(P=h(v))){return}M=P-1}else{if(z<=2){if(n&&v&&v.length>2){U[--T]=v.substring(2);v=v.substring(0,2)}if(isNaN(P=h(v))){return}M=P-1}else{for(var N=0;;++N){if(N==12){return}if(z==3){if(Q.SMON[N]==v){M=N;break}}else{if(v&&Q.FMON[N].startsWith(v)){M=N;break}}}}}if(M>11){return}break;case"E":if(n){c(v,U,--T,z)}break;case"d":if(n){v=c(v,U,--T,z)}if(!isNaN(P=h(v))){V=P;C=true;if(V<0||V>31){return}}break;case"H":case"h":case"K":case"k":if(x?(G=="H"||G=="k"):(G=="h"||G=="K")){break}if(n){v=c(v,U,--T,z)}if(!isNaN(P=h(v))){O=(G=="h"&&P==12)||(G=="k"&&P==24)?0:G=="K"?P%12:P}break;case"m":case"s":case"S":if(n){v=c(v,U,--T,z)}if(!isNaN(P=h(v))){if(G=="m"){W=P}else{if(G=="s"){H=P}else{B=P}}}break;case"a":if(!x){break}if(!v){return}K=v.startsWith(Q.APM[0]);break}S=R-1}else{t++}}if(x&&K===false){O+=12}var p=new Date(J,M,V,O,W,H,B);if(!C&&p.getMonth()!=M){p=new Date(J,M+1,0,O,W,H,B)}if(I){if(p.getFullYear()!=J||p.getMonth()!=M||p.getDate()!=V||p.getHours()!=O||p.getMinutes()!=W||p.getSeconds()!=H){return}r=r.trim();r=a(Q.FDOW,r);r=a(Q.SDOW,r);r=a(Q.S2DOW,r);r=a(Q.FMON,r);r=a(Q.SMON,r);r=a(Q.S2MON,r);r=a(Q.APM,r);for(var S=r.length;S--;){var G=r.charAt(S);if((G>"9"||G<"0")&&A.indexOf(G)<0){return}}}return +p==+E?E:p},formatDate:function(m,n,l){if(!n){n="yyyy/MM/dd"}l=l||{DOW_1ST:zk.DOW_1ST,ERA:zk.ERA,YDELTA:zk.YDELTA,SDOW:zk.SDOW,S2DOW:zk.S2DOW,FDOW:zk.FDOW,SMON:zk.SMON,S2MON:zk.S2MON,FMON:zk.FMON,APM:zk.APM};var r="";for(var q=0,u=n.length;q<u;++q){var o=n.charAt(q);if((o>="a"&&o<="z")||(o>="A"&&o<="Z")){var t=1,p;for(p=q;++p<u;++t){if(n.charAt(p)!=o){break}}switch(o){case"y":if(t<=3){r+=i(m.getFullYear()%100,2)}else{r+=i(m.getFullYear(),t)}break;case"M":if(t<=2){r+=i(m.getMonth()+1,t)}else{if(t==3){r+=l.SMON[m.getMonth()]}else{r+=l.FMON[m.getMonth()]}}break;case"d":r+=i(b(m),t);break;case"E":if(t<=3){r+=l.SDOW[(m.getDay()-l.DOW_1ST+7)%7]}else{r+=l.FDOW[(m.getDay()-l.DOW_1ST)%7]}break;case"D":r+=e(m);break;case"w":r+=f(m);break;case"W":r+=g(m);break;case"G":r+=l.ERA;break;case"F":r+=k(m);break;case"H":if(t<=2){r+=i(m.getHours(),t)}break;case"k":var s=m.getHours();if(s==0){s="24"}if(t<=2){r+=i(s,t)}break;case"K":if(t<=2){r+=i(m.getHours()%12,t)}break;case"h":var s=m.getHours();s%=12;if(s==0){s="12"}if(t<=2){r+=i(s,t)}break;case"m":if(t<=2){r+=i(m.getMinutes(),t)}break;case"s":if(t<=2){r+=i(m.getSeconds(),t)}break;case"S":if(t<=3){r+=i(m.getMilliseconds(),t)}break;case"Z":r+=-(m.getTimezoneOffset()/60);break;case"a":r+=l.APM[m.getHours()>11?1:0];break;default:r+="1"}q=p-1}else{if(o!="'"){r+=o}}}return r}};zk.fmt.Calendar=zk.$extends(zk.Object,{_offset:zk.YDELTA,$init:function(l,m){this._date=l;if(m){this._offset=m.YDELTA}},getTime:function(){return this._date},setTime:function(l){this._date=l},setYearOffset:function(l){this._offset=l},getYearOffset:function(){return this._offset},formatDate:function(n,l,o){var m;if(o){this._offset=o.YDELTA}if(this._offset){m=new Date(n);m.setFullYear(m.getFullYear()+this._offset)}return zk.fmt.Date.formatDate(m||n,l,o)},toUTCDate:function(){var l;if((l=this._date)&&this._offset){(l=new Date(l)).setFullYear(l.getFullYear()-this._offset)}return l},parseDate:function(p,n,t,s,l){var q=zk.fmt.Date.parseDate(p,n,t,s,l);if(l){this._offset=l.YDELTA}if(this._offset&&n){var m=0;for(var o=n.length;o--;){if(n.charAt(o)=="y"){m++}}if(m>3){q.setFullYear(q.getFullYear()-this._offset)}else{if(m){var r=q.getFullYear();if(r<2000){q.setFullYear(r+(Math.ceil(this._offset/100)*100-this._offset))}else{q.setFullYear(r-(this._offset%100))}}}}return q},getYear:function(){return this._date.getFullYear()+this._offset}})})();