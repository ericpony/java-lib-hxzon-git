(function(){function c(f){for(;f&&!f.$instanceof(zul.sel.Tree);f=f.parent){if(f.isOpen&&!f.isOpen()){return true}}}function b(g,h){if(h.isSelected()){g.$remove(h)}var f;if(f=h.treechildren){for(f=f.firstChild;f&&g.length;f=f.nextSibling){b(g,f)}}}function a(g,h){if(h.isSelected()){g.push(h)}var f;if(f=h.treechildren){for(f=f.firstChild;f;f=f.nextSibling){a(g,f)}}}function e(i,h){var j=i.$n();if(j){j.style.display=h?"":"none"}var g;if(g=i.treechildren){for(var f=g.firstChild;f;f=f.nextSibling){if(f._visible&&f._open){e(f,h)}}}}function d(g){if(zk.ie<8){var f=g.getTree();if(f){f.ebody.style.height="";f._syncBodyHeight()}}}zul.sel.Treeitem=zk.$extends(zul.sel.ItemWidget,{_open:true,$define:{open:function(k,j){var i=this.$n("open");if(!i||c(this.parent)){return}var l=i.className,g=this.getTree(),f=g?g.ebodytbl:null,h=f?f.clientWidth:0;i.className=k?l.replace("-close","-open"):l.replace("-open","-close");if(!k){zWatch.fireDown("onHide",this)}this._showKids(k);if(k){zUtl.fireShown(this)}if(g){g._sizeOnOpen();if(!j){this.fire("onOpen",{open:k},{toServer:g.inPagingMold()||g.isModel()})}g._syncFocus(this);g.focus();if(f){g._fixhdwcnt=g._fixhdwcnt||0;if(!g._fixhdwcnt++){g._fixhdoldwd=h}setTimeout(function(){if(!--g._fixhdwcnt&&g.$n()&&(g._fixhdoldwd!=f.clientWidth||(zk.ie<8))){g._calcSize()}},250)}}}},_showKids:function(h){var f=this.treechildren;if(f){for(var g=f.firstChild,i=f._isRealVisible();g;g=g.nextSibling){g.$n().style.display=i&&g.isVisible()&&h?"":"none";if(g.isOpen()){g._showKids(h)}}}},isStripeable_:function(){return false},getMeshWidget:_zkf=function(){return this.parent?this.parent.getTree():null},getTree:_zkf,getZclass:function(){if(this.treerow){return this.treerow.getZclass()}return null},$n:function(f){if(this.treerow){return f?this.treerow.$n(f):this.treerow.$n()||jq(this.treerow.uuid,zk)[0]}return null},isContainer:function(){return this.treechildren!=null},isEmpty:function(){return !this.treechildren||!this.treechildren.nChildren},getLevel:function(){var g=0;for(var f=this;;++g){if(!f.parent){break}f=f.parent.parent;if(!f||f.$instanceof(zul.sel.Tree)){break}}return g},getLabel:function(){var f=this.getFirstCell();return f?f.getLabel():null},setLabel:function(f){this._autoFirstCell().setLabel(f)},getFirstCell:function(){return this.treerow?this.treerow.firstChild:null},_autoFirstCell:function(){if(!this.treerow){this.appendChild(new zul.sel.Treerow())}var f=this.treerow.firstChild;if(!f){f=new zul.sel.Treecell();this.treerow.appendChild(f)}return f},getImage:function(){var f=this.getFirstCell();return f?f.getImage():null},setImage:function(f){this._autoFirstCell().setImage(f);return this},getParentItem:function(){var f=this.parent&&this.parent.parent?this.parent.parent:null;return f&&f.$instanceof(zul.sel.Treeitem)?f:null},_isRealVisible:function(){var f;return this.isVisible()&&(f=this.parent)&&f._isRealVisible()},_isVisibleInTree:function(){if(!this.isVisible()){return}var g=this.parent,f;if(!g||!g.isVisible()||!(f=g.parent)){return false}if(f.$instanceof(zul.sel.Tree)){return true}return f._isVisibleInTree()},setVisible:function(f){if(this.isVisible()!=f){this.$supers("setVisible",arguments);if(this.treerow){this.treerow.setVisible(f)}e(this,this._isRealVisible())}return this},doMouseOver_:function(f){var g=this.$n("open");if(f.domTarget==g){jq(this.$n()).addClass(this.getZclass()+"-ico-over")}this.$supers("doMouseOver_",arguments)},doMouseOut_:function(f){var g=this.$n("open");if(f.domTarget==g){jq(this.$n()).removeClass(this.getZclass()+"-ico-over")}this.$supers("doMouseOut_",arguments)},beforeParentChanged_:function(h){var g=this.getTree();if(g){g._onTreeitemRemoved(this)}if(h){var f=h.getTree();if(f){f._onTreeitemAdded(this)}}this.$supers("beforeParentChanged_",arguments)},insertBefore:function(h,g,f){if(this.$super("insertBefore",h,g,f||(!this.z_rod&&h.$instanceof(zul.sel.Treechildren)))){this._fixOnAdd(h,f);return true}},appendChild:function(g,f){if(this.$super("appendChild",g,f||(!this.z_rod&&g.$instanceof(zul.sel.Treechildren)))){if(!this.insertingBefore_){this._fixOnAdd(g,f)}return true}},_fixOnAdd:function(g,f){if(g.$instanceof(zul.sel.Treerow)){this.treerow=g}else{if(g.$instanceof(zul.sel.Treechildren)){this.treechildren=g;if(!f&&this.treerow){this.rerender()}}}},onChildRemoved_:function(f){this.$supers("onChildRemoved_",arguments);if(f==this.treerow){this.treerow=null;d(this)}else{if(f==this.treechildren){this.treechildren=null;if(!this.childReplacing_){this._syncIcon()}}}},onChildAdded_:function(f){this.$supers("onChildAdded_",arguments);if(this.childReplacing_){this._fixOnAdd(f,true)}if(this.desktop&&f.$instanceof(zul.sel.Treerow)){d(this)}},removeHTML_:function(h){for(var g,f=this.firstChild;f;f=f.nextSibling){g=f.$n();if(g){f.removeHTML_(g)}}this.$supers("removeHTML_",arguments)},replaceWidget:function(f){zul.sel.Treeitem._syncSelItems(this,f);if(this.treechildren){this.treechildren.detach()}this.$supers("replaceWidget",arguments)},_removeChildHTML:function(h){for(var g,f=this.firstChild;f;f=f.nextSibling){if(f!=this.treerow&&(g=f.$n())){f.removeHTML_(g)}}},_renderChildHTML:function(g){var f=this.previousSibling;for(;f;f=this.previousSibling){if(f.treerow){break}}if(f){jq(f.treerow.$n()).after(g)}else{if(f=this.nextSibling){for(;f;f=this.nextSibling){if(f.treerow){break}}if(f){jq(f.treerow.$n()).before(g)}}else{if(f=this.getParentItem()){f._renderChildHTML(g)}else{if((f=this.getTree())){jq(f.$n("rows")).append(g)}}}}},insertChildHTML_:function(h,f,g){if(f=f?f.getFirstNode_():null){jq(f).before(h.redrawHTML_())}else{this._renderChildHTML(h.redrawHTML_())}h.bind(g)},getOldWidget_:function(g){var f=this.$supers("getOldWidget_",arguments);if(f&&f.$instanceof(zul.sel.Treerow)){return f.parent}return f},replaceHTML:function(h,g,f){this._removeChildHTML(h);this.$supers("replaceHTML",arguments)},_syncIcon:function(){if(this.desktop&&this.treerow){var f=this.treerow;if(f=f.firstChild){f._syncIcon()}if(f=this.treechildren){for(f=f.firstChild;f;f=f.nextSibling){f._syncIcon()}}}}},{_syncSelItems:function(h,i){var f;if((f=h.getTree())&&(f=f._selItems)){if(h.$instanceof(zul.sel.Treechildren)){for(var g=h.firstChild;g;g=g.nextSibling){b(f,g)}for(var g=i.firstChild;g;g=g.nextSibling){a(f,g)}}else{b(f,h);a(f,i)}}}})})();