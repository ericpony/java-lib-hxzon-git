(function(){function b(d){var c;if((c=d.parent)&&c.lastChild==d){return d.previousSibling}}function a(c,f,d){if(!d){if(c){c._syncIcon()}var e;if((e=f.parent)&&e.lastChild==f&&(e=f.previousSibling)){e._syncIcon()}}}zul.sel.Treechildren=zk.$extends(zul.Widget,{getTree:function(){return this.isTopmost()?this.parent:this.parent?this.parent.getTree():null},getLinkedTreerow:function(){return this.parent?this.parent.treerow:null},isTopmost:function(){return this.parent&&this.parent.$instanceof(zul.sel.Tree)},insertBefore:function(f,e,d){var c=b(f);if(this.$supers("insertBefore",arguments)){a(c,f,d);return true}},appendChild:function(e,d){var c=b(e);if(this.$supers("appendChild",arguments)){if(!this.insertingBefore_){a(c,e,d)}return true}},insertChildHTML_:function(g,e,f){var d,c=this.isTopmost();if(e){e=e.getFirstNode_()}if(!e&&!c){d=this.getCaveNode()||this.parent.getCaveNode()}if(e){jq(e).before(g.redrawHTML_())}else{if(d){jq(d).after(g.redrawHTML_())}else{if(c){jq(this.parent.$n("rows")).append(g.redrawHTML_())}else{jq(this).append(g.redrawHTML_())}}}g.bind(f)},getCaveNode:function(){for(var e,c=this.lastChild;c;c=c.previousSibling){if((e=c.getCaveNode())){if(c.treechildren){var d=c.treechildren.getCaveNode();if(d){e=d}}return e}}},isRealVisible:function(){this._isRealVisible()&&this.$supers("isRealVisible",arguments)},_isRealVisible:function(){var c;return this.isVisible()&&(this.isTopmost()||((c=this.parent)&&c.isOpen()&&c._isRealVisible()))},getItems:function(d,f){d=d||[];var e=f&&f.skipHidden;for(var c=this.firstChild;c;c=c.nextSibling){if(!e||c.isVisible()){d.push(c);if(c.treechildren&&(!e||c.isOpen())){c.treechildren.getItems(d,f)}}}return d},getItemCount:function(){var d=0;for(var c=this.firstChild;c;c=c.nextSibling,++d){if(c.treechildren){d+=c.treechildren.getItemCount()}}return d},getZclass:function(){return this._zclass==null?"z-treechildren":this._zclass},beforeParentChanged_:function(e){var d=this.getTree();if(d){d._onTreechildrenRemoved(this)}if(e){var c=e.$instanceof(zul.sel.Tree)?e:e.getTree();if(c){c._onTreechildrenAdded(this)}}this.$supers("beforeParentChanged_",arguments)},removeHTML_:function(e){for(var d,c=this.firstChild;c;c=c.nextSibling){d=c.$n();if(d){c.removeHTML_(d)}}this.$supers("removeHTML_",arguments)},getOldWidget_:function(e){var c=this.$supers("getOldWidget_",arguments);if(c&&c.$instanceof(zul.sel.Treerow)){var d=c.parent;if(d){return d.treechildren}return null}return c},$n:function(c){if(this.firstChild){return c?this.firstChild.$n(c):this.firstChild.$n()}return null},replaceWidget:function(c){while(this.firstChild!=this.lastChild){this.lastChild.detach()}if(this.firstChild&&this.firstChild.treechildren){this.firstChild.treechildren.detach()}zul.sel.Treeitem._syncSelItems(this,c);this.$supers("replaceWidget",arguments)},onChildAdded_:function(c){this.$supers("onChildAdded_",arguments);if(this.desktop){this.getTree()._syncSize()}},onChildRemoved_:function(e){this.$supers("onChildRemoved_",arguments);var d=this._selItems,c;if(this.desktop){this.getTree()._syncSize()}}})})();