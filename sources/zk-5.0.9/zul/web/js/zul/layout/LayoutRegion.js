(function(){function a(e,c,b){var d=e.firstChild;if(d){if(c){e._fcvflex=d.getVflex();e._fchflex=d.getHflex();if(!b||d._vflex!="min"){d.setVflex(true)}if(!b||d._hflex!="min"){d.setHflex(true)}}else{d.setVflex(e._fcvflex);d.setHflex(e._fchflex);delete e._fcvflex;delete e._fchflex}}}zul.layout.LayoutRegion=zk.$extends(zul.Widget,{_open:true,_border:"normal",_maxsize:2000,_minsize:0,$init:function(){this.$supers("$init",arguments);this._margins=[0,0,0,0];this._cmargins=[3,3,3,3]},$define:{flex:function(b){a(this,b);this.rerender()},border:function(b){if(!b||"0"==b){this._border=b="none"}if(this.desktop){(this.$n("real")||{})._lastSize=null}this.updateDomClass_()},title:function(){this.rerender()},splittable:function(b){if(this.parent&&this.desktop){this.parent.resize()}},maxsize:null,minsize:null,collapsible:function(c){var b=this.$n(this._open?"btn":"btned");if(b){b.style.display=c?"":"none"}},autoscroll:function(c){var d=this.$n("cave");if(d){var b=this.isFlex()&&this.firstChild?this.firstChild.$n():d;if(c){b.style.overflow="auto";b.style.position="relative";this.domListen_(b,"onScroll")}else{b.style.overflow="hidden";b.style.position="";this.domUnlisten_(b,"onScroll")}}},open:function(e,d,b){if(!this.$n()||!this.isCollapsible()||!this.parent){return}b=this.parent._animationDisabled||b;var c=this.$n("colled"),g=this.$n("real");if(e){if(d){if(!zk(this.$n()).isRealVisible()){if(c){jq(g).show();jq(c).hide()}return}var f=this.$n("real").style;f.visibility="hidden";f.display="";this._syncSize(true);f.visibility="";f.display="none";this._open=true}if(c){if(!b){zk(c).slideOut(this,{anchor:this.sanchor,duration:200,afterAnima:d?this.$class.afterSlideOut:this.$class._afterSlideOutX})}else{jq(g).show();jq(c).hide();zUtl.fireShown(this)}}}else{if(c&&!b){zk(g).slideOut(this,{anchor:this.sanchor,beforeAnima:this.$class.beforeSlideOut,afterAnima:d?this.$class.afterSlideOut:this.$class._afterSlideOutX})}else{if(c){jq(c).show()}jq(g).hide()}}if(b){this.parent.resize()}if(!d&&b){this.fire("onOpen",{open:e})}}},setVflex:function(b){if(b!="min"){b=false}this.$super(zul.layout.LayoutRegion,"setVflex",b)},setHflex:function(b){if(b!="min"){b=false}this.$super(zul.layout.LayoutRegion,"setHflex",b)},getChildMinSize_:function(c,b){return(c=="h"&&this.$n("cap")?this.$n("cap").offsetHeight:0)+this.$supers("getChildMinSize_",arguments)},getCmargins:function(){return zUtl.intsToString(this._open?this._margins:this._cmargins)},setCmargins:function(b){if(this.getCmargins()!=b){this._cmargins=zUtl.stringToInts(b,0);if(this.parent&&this.desktop){this.parent.resize()}}},getCurrentMargins_:function(){return zul.layout.LayoutRegion._aryToObject(this._open?this._margins:this._cmargins)},getMargins:function(){return zUtl.intsToString(this._margins)},setMargins:function(b){if(this.getMargins()!=b){this._margins=zUtl.stringToInts(b,0);if(this.parent&&this.desktop){this.parent.resize()}}},domClass_:function(d){var c=this.$supers("domClass_",arguments);if(!d||!d.zclass){var b="normal"==this.getBorder()?"":this.getZclass()+"-noborder";if(b){c+=(c?" ":"")+b}}return c},getZclass:function(){return this._zclass==null?"z-"+this.getPosition():this._zclass},getMarginSize_:function(b){return zk(this.$n("real")).sumStyles(b=="h"?"tb":"lr",jq.margins)},setWidth:function(b){this._width=b;var c=this.$n("real");if(c){c.style.width=b?b:"";c._lastSize=null;this.parent.resize()}return this},setHeight:function(b){this._height=b;var c=this.$n("real");if(c){c.style.height=b?b:"";c._lastSize=null;this.parent.resize()}return this},setVisible:function(c){if(this._visible!=c){this.$supers("setVisible",arguments);var d=this.$n("real");var b=this.$n("colled");if(d){if(this._visible){if(this._open){jq(d).show();if(b){jq(b).hide()}}else{jq(d).hide();if(b){jq(b).show()}}}else{jq(d).hide();if(b){jq(b).hide()}}this.parent.resize()}}return this},setFlexSize_:function(d){var f=this.$n("real");if(d.height!==undefined){if(d.height=="auto"){f.style.height=""}else{if(d.height==""){f.style.height=this._height?this._height:""}else{var e=this.$n("cave"),c=e&&this._vflex!="min"?(e.offsetHeight+e.offsetTop):zk(f).revisedHeight(d.height,true);if(zk.ie){f.style.height=""}f.style.height=jq.px0(c)}}}if(d.width!==undefined){if(d.width=="auto"){f.style.width=""}else{if(d.width==""){f.style.width=this._width?this._width:""}else{var b=zk(f).revisedWidth(d.width,true);if(zk.ie){f.style.width=""}f.style.width=jq.px0(b)}}}return{height:f.offsetHeight,width:f.offsetWidth}},updateDomClass_:function(){if(this.desktop){var b=this.$n("real");if(b){b.className=this.domClass_();if(this.parent){this.parent.resize()}}}},updateDomStyle_:function(){if(this.desktop){var b=this.$n("real");if(b){zk(b).clearStyles().jq.css(jq.parseStyle(this.domStyle_()));if(this.parent){this.parent.resize()}}}},onChildAdded_:function(b){this.$supers("onChildAdded_",arguments);if(b.$instanceof(zul.layout.Borderlayout)){this.setFlex(true);jq(this.$n()).addClass(this.getZclass()+"-nested")}if(this.isFlex()){a(this,true,true)}(this.$n("real")||{})._lastSize=null;if(this.parent&&this.desktop){this.parent.resize()}},onChildRemoved_:function(b){this.$supers("onChildRemoved_",arguments);if(this.isFlex()){a(this,false)}if(b.$instanceof(zul.layout.Borderlayout)){this.setFlex(false);jq(this.$n()).removeClass(this.getZclass()+"-nested")}(this.$n("real")||{})._lastSize=null;if(this.parent&&this.desktop&&!this.childReplacing_){this.parent.resize()}},rerender:function(){this.$supers("rerender",arguments);if(this.parent){this.parent.resize()}return this},bind_:function(){this.$supers(zul.layout.LayoutRegion,"bind_",arguments);if(this.getPosition()!=zul.layout.Borderlayout.CENTER){var f=this.$n("split");if(f){this._fixSplit();var d=this._isVertical(),e=this.$class;this._drag=new zk.Draggable(this,f,{constraint:d?"vertical":"horizontal",ghosting:e._ghosting,snap:e._snap,zIndex:12000,overlay:true,initSensitivity:0,ignoredrag:e._ignoredrag,endeffect:e._endeffect});if(!this._open){var c=this.$n("colled"),h=this.$n("real");if(c){jq(c).show()}jq(h).hide()}if(!this._visible){var c=this.$n("colled"),h=this.$n("real");jq(h).hide();if(c){jq(c).hide()}}}}var g=this.$n(),h=g.firstChild;if(this._open&&!this.isVisible()){g.style.display="none"}if(this.isAutoscroll()){var b=this.isFlex()&&this.firstChild?this.firstChild.$n():this.$n("cave");this.domListen_(b,"onScroll")}if(this.isFlex()){a(this,true,true)}},unbind_:function(){if(this.isAutoscroll()){var b=this.isFlex()&&this.firstChild?this.firstChild.$n():this.$n("cave");this.domUnlisten_(b,"onScroll")}if(this.$n("split")){if(this._drag){this._drag.destroy();this._drag=null}}if(this.isFlex()){a(this,false)}this.$supers(zul.layout.LayoutRegion,"unbind_",arguments)},doMouseOver_:function(b){switch(b.domTarget){case this.$n("btn"):jq(this.$n("btn")).addClass(this.getZclass()+"-colps-over");break;case this.$n("btned"):jq(this.$n("btned")).addClass(this.getZclass()+"-exp-over");case this.$n("colled"):jq(this.$n("colled")).addClass(this.getZclass()+"-colpsd-over");break;case this.$n("splitbtn"):jq(this.$n("splitbtn")).addClass(this.getZclass()+"-splt-btn-over");break}this.$supers("doMouseOver_",arguments)},doMouseOut_:function(b){switch(b.domTarget){case this.$n("btn"):jq(this.$n("btn")).removeClass(this.getZclass()+"-colps-over");break;case this.$n("btned"):jq(this.$n("btned")).removeClass(this.getZclass()+"-exp-over");case this.$n("colled"):jq(this.$n("colled")).removeClass(this.getZclass()+"-colpsd-over");break;case this.$n("splitbtn"):jq(this.$n("splitbtn")).removeClass(this.getZclass()+"-splt-btn-over");break}this.$supers("doMouseOut_",arguments)},doClick_:function(b){var d=b.domTarget;switch(d){case this.$n("btn"):case this.$n("btned"):case this.$n("splitbtn"):if(this._isSlide||zk.animating()){return}if(this.$n("btned")==d){var c=this.$n("real").style;c.visibility="hidden";c.display="";this._syncSize(true);c.visibility="";c.display="none"}this.setOpen(!this._open);break;case this.$n("colled"):if(this._isSlide){return}this._isSlide=true;var e=this.$n("real"),c=e.style;c.visibility="hidden";c.display="";this._syncSize();this._original=[c.left,c.top];this._alignTo();c.zIndex=100;if(this.$n("btn")){this.$n("btn").style.display="none"}c.visibility="";c.display="none";zk(e).slideDown(this,{anchor:this.sanchor,afterAnima:this.$class.afterSlideDown});break}this.$supers("doClick_",arguments)},_docClick:function(b){var c=b.target;if(this._isSlide&&!jq.isAncestor(this.$n("real"),c)){if(this.$n("btned")==c){this.$class.afterSlideUp.apply(this,[c]);this.setOpen(true,false,true)}else{if((!this._isSlideUp&&this.$class.uuid(c)!=this.uuid)||!zk.animating()){this._isSlideUp=true;zk(this.$n("real")).slideUp(this,{anchor:this.sanchor,afterAnima:this.$class.afterSlideUp})}}}},_syncSize:function(o){var l=this.parent,d=l.$n(),c=d.offsetWidth,q=d.offsetHeight,b={x:0,y:0,w:c,h:q};this._open=true;for(var n,p,g,f=["north","south","west","east"],i=0,e=f.length;i<e;++i){n=l[f[i]];if(n&&(zk(n.$n()).isVisible()||zk(n.$n("colled")).isVisible())){var m=n==this,p=n._ambit(m),r=this.$class;switch(f[i]){case"north":case"south":p.w=c-p.w;if(f[i]=="north"){b.y=p.ts}else{p.y=q-p.y}b.h-=p.ts;if(m){p.w=this.$n("colled").offsetWidth;if(o){var h=r._aryToObject(this._cmargins);p.w+=h.left+h.right}l._resizeWgt(n,p,true);this._open=false;return}break;default:p.y+=b.y;p.h=b.h-p.h;if(f[i]=="east"){p.x=c-p.x}else{b.x+=p.ts}b.w-=p.ts;if(m){p.h=this.$n("colled").offsetHeight;if(o){var h=r._aryToObject(this._cmargins);p.h+=h.top+h.bottom}l._resizeWgt(n,p,true);this._open=false;return}break}}}},_alignTo:function(){var d=this.$n("colled"),c=this.$n("real"),b=zul.layout.Borderlayout;switch(this.getPosition()){case b.NORTH:c.style.top=jq.px(d.offsetTop+d.offsetHeight);c.style.left=jq.px(d.offsetLeft);break;case b.SOUTH:c.style.top=jq.px(d.offsetTop-c.offsetHeight);c.style.left=jq.px(d.offsetLeft);break;case b.WEST:c.style.left=jq.px(d.offsetLeft+d.offsetWidth);c.style.top=jq.px(d.offsetTop);break;case b.EAST:c.style.left=jq.px(d.offsetLeft-c.offsetWidth);c.style.top=jq.px(d.offsetTop);break}},_doScroll:function(){zWatch.fireDown("onScroll",this)},_fixSplit:function(){jq(this.$n("split"))[this._splittable?"show":"hide"]()},_isVertical:function(){var b=zul.layout.Borderlayout;return this.getPosition()!=b.WEST&&this.getPosition()!=b.EAST},_ambit:function(g){var k,l=this.getCurrentMargins_(),i=this.getPosition();if(i&&!this._open){var e=this.$n("colled");k={x:l.left,y:l.top,w:e?e.offsetWidth:0,h:e?e.offsetHeight:0};g=true}else{var c=this.parent.$n(),j=this.getWidth()||"",d=this.getHeight()||"",b;k={x:l.left,y:l.top,w:(b=j.indexOf("%"))>0?Math.max(Math.floor(c.offsetWidth*zk.parseInt(j.substring(0,b))/100),0):this.$n("real").offsetWidth,h:(b=d.indexOf("%"))>0?Math.max(Math.floor(c.offsetHeight*zk.parseInt(d.substring(0,b))/100),0):this.$n("real").offsetHeight}}var f=g?{offsetHeight:0,offsetWidth:0}:this.$n("split")||{offsetHeight:0,offsetWidth:0};if(!g){this._fixSplit()}this._ambit2(k,l,f);return k},_ambit2:zk.$void,_reszSplt:function(c){var d=this.$n("split"),b=this.$n("splitbtn");if(zk(d).isVisible()){if(zk(b).isVisible()){if(this._isVertical()){b.style.marginLeft=jq.px0(((c.w-b.offsetWidth)/2))}else{b.style.marginTop=jq.px0(((c.h-b.offsetHeight)/2))}}zk.copy(d.style,this._reszSp2(c,{w:d.offsetWidth,h:d.offsetHeight}))}return c},_reszSp2:zk.$void},{_aryToObject:function(b){return{top:b[0],left:b[1],right:b[2],bottom:b[3]}},beforeSlideOut:function(c){var b=this.$n("colled").style;b.display="";b.visibility="hidden";b.zIndex=1;this.parent.resize()},_afterSlideOutX:function(b){this.$class.afterSlideOut.call(this,b,true)},afterSlideOut:function(e,b){if(this._open){zk(this.$n("real")).slideIn(this,{anchor:this.sanchor,afterAnima:b?this.$class._afterSlideInX:this.$class.afterSlideIn})}else{var c=this.$n("colled"),d=c.style;d.zIndex="";d.visibility="";zk(c).slideIn(this,{anchor:this.sanchor,duration:200,afterAnima:b?function(f){this.fire("onOpen",{open:this._open})}:zk.$void})}},_afterSlideInX:function(b){this.$class.afterSlideIn.call(this,b);this.fire("onOpen",{open:this._open})},afterSlideIn:function(b){this.parent.resize()},afterSlideDown:function(b){jq(document).click(this.proxy(this._docClick))},afterSlideUp:function(c){var b=c.style;b.left=this._original[0];b.top=this._original[1];c._lastSize=null;b.zIndex="";if(this.$n("btn")){this.$n("btn").style.display=""}jq(document).unbind("click",this.proxy(this._docClick));this._isSlideUp=this._isSlide=false},_ignoredrag:function(v,q,m){var w=m.domTarget,j=v.control;if(!w||w!=j.$n("split")){return true}if(j.isSplittable()&&j._open){var u=zul.layout.Borderlayout,e=j.getPosition(),d=j.getMaxsize(),f=j.getMinsize(),k=j.parent,n=j.$n("real"),b=zul.layout.LayoutRegion._aryToObject(j._margins),t=zk(n).padBorderWidth(),g=t+(e==u.WEST?b.left:b.right),i=t+(e==u.NORTH?b.top:b.bottom),p=0,s=j.uuid;switch(e){case u.NORTH:case u.SOUTH:var l=k.center||(e==u.NORTH?k.south:k.north);if(l){if(u.CENTER==l.getPosition()){var h=k.east,c=k.west;d=Math.min(d,(n.offsetHeight+l.$n("real").offsetHeight)-p)}else{d=Math.min(d,k.$n().offsetHeight-l.$n("real").offsetHeight-l.$n("split").offsetHeight-j.$n("split").offsetHeight-p)}}else{d=k.$n().offsetHeight-j.$n("split").offsetHeight}break;case u.WEST:case u.EAST:var l=k.center||(e==u.WEST?k.east:k.west);if(l){if(u.CENTER==l.getPosition()){d=Math.min(d,(n.offsetWidth+zk(l.$n("real")).revisedWidth(l.$n("real").offsetWidth))-p)}else{d=Math.min(d,k.$n().offsetWidth-l.$n("real").offsetWidth-l.$n("split").offsetWidth-j.$n("split").offsetWidth-p)}}else{d=k.$n().offsetWidth-j.$n("split").offsetWidth}break}var o=zk(n).cmOffset();v._rootoffs={maxs:d,mins:f,top:o[1]+i,left:o[0]+g,right:n.offsetWidth,bottom:n.offsetHeight};return false}return true},_endeffect:function(d,b){var e=d.control,c="";if(e._isVertical()){e.setHeight(d._point[1]+"px")}else{e.setWidth(d._point[0]+"px")}e.$n().style.zIndex="";d._rootoffs=d._point=null;e.parent.resize();e.fire("onSize",zk.copy({width:e.$n("real").style.width,height:e.$n("real").style.height},b.data))},_snap:function(g,c){var m=g.control,k=c[0],f=c[1],i=zul.layout.Borderlayout,e=m.$n("split"),j=g._rootoffs,l,d;switch(m.getPosition()){case i.NORTH:if(f>j.maxs+j.top){f=j.maxs+j.top}if(f<j.mins+j.top){f=j.mins+j.top}l=k;d=f-j.top;break;case i.SOUTH:if(j.top+j.bottom-f-e.offsetHeight>j.maxs){f=j.top+j.bottom-j.maxs-e.offsetHeight;d=j.maxs}else{if(j.top+j.bottom-j.mins-e.offsetHeight<=f){f=j.top+j.bottom-j.mins-e.offsetHeight;d=j.mins}else{d=j.top-f+j.bottom-e.offsetHeight}}l=k;break;case i.WEST:if(k>j.maxs+j.left){k=j.maxs+j.left}if(k<j.mins+j.left){k=j.mins+j.left}l=k-j.left;d=f;break;case i.EAST:if(j.left+j.right-k-e.offsetWidth>j.maxs){k=j.left+j.right-j.maxs-e.offsetWidth;l=j.maxs}else{if(j.left+j.right-j.mins-e.offsetWidth<=k){k=j.left+j.right-j.mins-e.offsetWidth;l=j.mins}else{l=j.left-k+j.right-e.offsetWidth}}d=f;break}g._point=[l,d];return[k,f]},_ghosting:function(f,e,b){var d=f.node,c=zk(d);jq(document.body).prepend('<div id="zk_layoutghost" style="font-size:0;line-height:0;background:#AAA;position:absolute;top:'+e[1]+"px;left:"+e[0]+"px;width:"+c.offsetWidth()+"px;height:"+c.offsetHeight()+"px;cursor:"+d.style.cursor+';"></div>');return jq("#zk_layoutghost")[0]}})})();