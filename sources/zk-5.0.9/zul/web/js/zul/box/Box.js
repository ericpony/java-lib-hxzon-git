(function(){function d(e){return e&&e.startsWith("0")&&(e.length==1||zUtl.isChar(e.charAt(1),{digit:1}))}function c(i,l){var e=[],k=i._spacing,j=d(k),g=i.isVertical(),f=k&&k!="auto"?(g?"height:":"width:")+k:"";e.push("<t",g?"r":"d",' id="',l.uuid,'-chdex2" class="',i.getZclass(),'-sep"');var h=f;if(j||!l.isVisible()){h="display:none;"+h}if(h){e.push(' style="',h,'"')}e.push(">",g?"<td>":"",zUtl.img0,g?"</td></tr>":"</td>");return e.join("")}function a(){var j=this.isVertical();if(this._isStretchAlign()||(j&&this._nhflex)||(!j&&this._nvflex)){for(var f=this.firstChild;f;f=f.nextSibling){if(f.isVisible()){var n=f.$n();if(j){if(f._nhflex&&f._nhflex>0){f.setFlexSize_({width:"auto"})}else{if(n&&this._isStretchAlign()){var k=n.style.width;if(k){var i=n.offsetWidth;n.style.width="";if(n.offsetWidth>i){n.style.width=k}}}}if(!f.$instanceof(zul.wgt.Cell)&&this._nhflex){var l=f.$n("chdex");l.style.width=""}}else{if(f._nvflex&&f._nvflex>0){f.setFlexSize_({height:"auto"})}else{if(n&&this._isStretchAlign()){var m=n.style.height;if(m){var e=n.offsetHeight;n.style.height="";if(n.offsetHeight>e){n.style.height=m}}}}if(!f.$instanceof(zul.wgt.Cell)&&this._nvflex){var l=f.$n("chdex");l.style.height=""}}}}}if(zk.safari&&!j&&this.$n().style.height){var h=this.$n("frame");h.style.height="";var g=h.offsetHeight;h.style.height=g+"px"}}var b=zul.box.Box=zk.$extends(zul.Widget,{_mold:"vertical",_align:"start",_pack:"start",_sizedByContent:true,$define:{align:_zkf=function(){this.rerender()},pack:_zkf,spacing:_zkf,sizedByContent:_zkf,widths:_zkf=function(e){this._sizes=e;this.rerender()}},setHeights:function(e){this.setWidths(e)},getHeights:function(){return this.getWidths()},isVertical:function(){return"vertical"==this._mold},getOrient:function(){return this._mold},getZclass:function(){var e=this._zclass;return e!=null?e:this.isVertical()?"z-vbox":"z-hbox"},onChildVisible_:function(e){this.$supers("onChildVisible_",arguments);if(this.desktop){this._fixChildDomVisible(e,e._visible)}},replaceChildHTML_:function(f){this.$supers("replaceChildHTML_",arguments);this._fixChildDomVisible(f,f._visible);if(f.$instanceof(zul.box.Splitter)){var e=this._chdextr(f);if(e){e.style.height="";e.style.width=""}zUtl.fireSized(this,-1)}},_fixChildDomVisible:function(g,e){var f=this._chdextr(g);if(f){f.style.display=e?"":"none"}f=g.$n("chdex2");if(f){f.style.display=e&&!d(this._spacing)?"":"none"}if(this.lastChild==g){f=g.previousSibling;if(f){f=f.$n("chdex2");if(f){f.style.display=e?"":"none"}}}},_chdextr:function(e){return e.$n("chdex")||e.$n()},insertChildHTML_:function(i,f,h){if(f){jq(this._chdextr(f)).before(this.encloseChildHTML_(i))}else{var g=this.$n("real"),e=g.tBodies;if(!e||!e.length){g.appendChild(document.createElement("tbody"))}jq(this.isVertical()?e[0]:e[0].rows[0]).append(this.encloseChildHTML_(i,true))}i.bind(h)},removeChildHTML_:function(f){this.$supers("removeChildHTML_",arguments);jq(f.uuid+"-chdex",zk).remove();jq(f.uuid+"-chdex2",zk).remove();var e;if(this.lastChild==f&&(e=f.previousSibling)){jq(e.uuid+"-chdex2",zk).remove()}},encloseChildHTML_:function(e,k,g){var m=[],i=e.$instanceof(zul.wgt.Cell);if(this.isVertical()){m.push('<tr id="',e.uuid,'-chdex"',this._childOuterAttrs(e),">");if(!i){m.push("<td",this._childInnerAttrs(e));var n=this.getAlign();if(n&&n!="stretch"){m.push(' align="',zul.box.Box._toHalign(n),'"')}m.push(">")}e.redraw(m);if(!i){m.push("</td>")}m.push("</tr>")}else{if(!i){m.push('<td id="',e.uuid,'-chdex"',this._childOuterAttrs(e),this._childInnerAttrs(e),">")}e.redraw(m);if(!i){m.push("</td>")}}if(e.nextSibling){m.push(c(this,e))}else{if(k){var f=e.previousSibling;if(f){m.unshift(c(this,f))}}}if(!g){return m.join("")}for(var h=0,l=m.length;h<l;++h){g.push(m[h])}},_resetBoxSize:function(){var n=this.isVertical(),i=-1,j=this._sizes;if(n){for(var l=this.firstChild;l;l=l.nextSibling){if(j&&!l.$instanceof(zul.box.Splitter)&&!l.$instanceof(zul.wgt.Cell)){++i}if(l._nvflex&&l.getVflex()!="min"){l.setFlexSize_({height:"",width:""});var q=l.$n("chdex");if(q){q.style.height=j&&i<j.length?j[i]:"";q.style.width=""}}}}else{for(var l=this.firstChild;l;l=l.nextSibling){if(j&&!l.$instanceof(zul.box.Splitter)&&!l.$instanceof(zul.wgt.Cell)){++i}if(l._nhflex&&l.getHflex()!="min"){l.setFlexSize_({height:"",width:""});var q=l.$n("chdex");if(q){q.style.width=j&&i<j.length?j[i]:"";q.style.height=""}}}}var g=this.$n(),m=zk(g),s=g.offsetHeight,f=g.offsetWidth,r=this._vflexsz!==undefined?this._vflexsz-m.sumStyles("tb",jq.margins):s,e=this._hflexsz!==undefined?this._hflexsz-m.sumStyles("lr",jq.margins):f,h=m.revisedHeight(r<s?r:s),o=m.revisedWidth(e<f?e:f);return m?{height:h,width:o}:{}},resetSize_:function(i){this.$supers(zul.Widget,"resetSize_",arguments);var h=this.isVertical(),g=-1,f=this._sizes;if(h){for(var e=this.firstChild;e;e=e.nextSibling){if(f&&!e.$instanceof(zul.box.Splitter)&&!e.$instanceof(zul.wgt.Cell)){++g}if(e._nvflex&&e.getVflex()!="min"){var j=e.$n("chdex");if(j){if(i=="h"){j.style.height=f&&g<f.length?f[g]:""}if(i=="w"){j.style.width=""}}}}}else{for(var e=this.firstChild;e;e=e.nextSibling){if(f&&!e.$instanceof(zul.box.Splitter)&&!e.$instanceof(zul.wgt.Cell)){++g}if(e._nhflex&&e.getHflex()!="min"){var j=e.$n("chdex");if(j){if(i=="w"){j.style.width=f&&g<f.length?f[g]:""}if(i=="h"){j.style.height=""}}}}}},beforeChildrenFlex_:function(l){if(l._flexFixed||(!l._nvflex&&!l._nhflex)){delete l._flexFixed;return false}l._flexFixed=true;var B=this.isVertical(),D=[],I=B?0:1,e=[],F=!B?0:1,x=l.$n("chdex"),u=x?x.parentNode:l.$n().parentNode,r=zk(u),q=this._resetBoxSize(),m=q.height,w=q.width,A=u.firstChild,y=-1,s=this._sizes;for(;A;A=A.nextSibling){var G=A.id&&A.id.endsWith("-chdex")?B?A.firstChild.id?A.firstChild:A.firstChild.firstChild:A.firstChild:A,C=zk(G),t=false;if(C.isVisible()){var z=G.id?G.id.indexOf("-"):1,i=z<0?zk.Widget.$(G.id):null;if(s&&i&&!i.$instanceof(zul.box.Splitter)&&!i.$instanceof(zul.wgt.Cell)){++y;if(y<s.length&&s[y]&&((B&&!i._nvflex)||(!B&&!i._nhflex))){G=A;C=zk(G);t=s[y].endsWith("px")}}var h=t&&B?zk.parseInt(s[y]):zk.ie&&A.id&&A.id.endsWith("-chdex2")&&A.style.height&&A.style.height.endsWith("px")?zk.parseInt(A.style.height):C.offsetHeight(),o=t&&!B?zk.parseInt(s[y]):C.offsetWidth(),n=o+C.sumStyles("lr",jq.margins),g=h+C.sumStyles("tb",jq.margins);if(i&&i._nvflex){if(i!==l){i._flexFixed=true}if(i._vflex=="min"){i.fixMinFlex_(G,"h")}else{D.push(i);if(B){I+=i._nvflex}}}else{if(B){m-=g}}if(i&&i._nhflex){if(i!==l){i._flexFixed=true}if(i._hflex=="min"){i.fixMinFlex_(G,"w")}else{e.push(i);if(!B){F+=i._nhflex}}}else{if(!B){w-=n}}}}var H=m>0?m:0;for(var z=D.length-1;z>0;--z){var i=D.shift(),E=(i._nvflex*m/I)|0,v=E;i.setFlexSize_({height:v});i._vflexsz=E;if(!i.$instanceof(zul.wgt.Cell)){var x=i.$n("chdex");x.style.height=jq.px0(zk(x).revisedHeight(E,true))}if(B){H-=E}}if(D.length){var i=D.shift(),v=H;i.setFlexSize_({height:v});i._vflexsz=H;if(!i.$instanceof(zul.wgt.Cell)){var x=i.$n("chdex");x.style.height=jq.px0(zk(x).revisedHeight(H,true))}}H=w>0?w:0;for(var z=e.length-1;z>0;--z){var i=e.shift(),f=(i._nhflex*w/F)|0;i.setFlexSize_({width:f});i._hflexsz=f;if(!i.$instanceof(zul.wgt.Cell)){var x=i.$n("chdex");x.style.width=jq.px0(zk(x).revisedWidth(f,true))}if(!B){H-=f}}if(e.length){var i=e.shift();i.setFlexSize_({width:H});i._hflexsz=H;if(!i.$instanceof(zul.wgt.Cell)){var x=i.$n("chdex");x.style.width=jq.px0(zk(x).revisedWidth(H,true))}}l.parent.afterChildrenFlex_(l);l._flexFixed=false;if(zk.ie<8){zk(this).redoCSS()}return false},_childOuterAttrs:function(g){var f="";if(g.$instanceof(zul.box.Splitter)){f=' class="'+g.getZclass()+'-outer"'}else{if(this.isVertical()){if(this._isStretchPack()){var e=this._pack2;f=' valign="'+(e?zul.box.Box._toValign(e):"top")+'"'}else{f=' valign="top"'}}else{return""}}if(!g.isVisible()){f+=' style="display:none"'}return f},_childInnerAttrs:function(f){var k="",l=this.isVertical(),g=zul.box.Splitter;if(f.$instanceof(g)){return l?' class="'+f.getZclass()+'-outer-td"':""}if(this._isStretchPack()){var o=l?this.getAlign():this._pack2;if(o){k+=' align="'+zul.box.Box._toHalign(o)+'"'}}var e="",i=this._sizes;if(i){for(var h=0,m=i.length,n=this.firstChild;n&&h<m;n=n.nextSibling){if(f==n){e=(l?"height:":"width:")+i[h];break}if(!n.$instanceof(g)){++h}}}if(!l&&!f.isVisible()){e+=e?";display:none":"display:none"}if(!l){e+=e?";height:100%":"height:100%"}return e?k+' style="'+e+'"':k},_isStretchPack:function(){return this._splitterKid||this._stretchPack},_isStretchAlign:function(){return this._align=="stretch"},_bindWatch:function(){if(!this._watchBound){this._watchBound=true;zWatch.listen({onSize:this,onHide:this})}},_unbindWatch:function(){if(this._watchBound){zWatch.unlisten({onSize:this,onHide:this});delete this._watchBound}},bind_:function(){this.$supers(b,"bind_",arguments);this._bindFixTd();if(this._isStretchAlign()){this._bindAlign()}if(this._splitterKid){this._bindWatch()}},unbind_:function(){this._unbindWatch();this._unbindAlign();this._unbindFixTd();this.$supers(b,"unbind_",arguments)},_bindAlign:function(){if(!this._watchAlign){this._watchAlign=true;zWatch.listen({onSize:[this,this._fixAlign],onHide:[this,this._fixAlign]})}},_unbindAlign:function(){if(this._watchAlign){zWatch.unlisten({onSize:[this,this._fixAlign],onHide:[this,this._fixAlign]});delete this._watchAlign}},_fixAlign:function(){if(this._isStretchAlign()){var e=this.isVertical(),j=this.$n("frame"),g=zk(j),f=e?g.revisedWidth(j.offsetWidth):g.revisedHeight(j.offsetHeight);for(var i=this.firstChild,h;i;i=i.nextSibling){if(i.isVisible()&&(h=i.$n())){if(e){h.style.width=zk(h).revisedWidth(f,!zk.safari)+"px"}else{h.style.height=zk(h).revisedHeight(f-((zk.ie&&h.offsetTop>0)?(h.offsetTop*2):0),!zk.safari)+"px"}}}}},_bindFixTd:function(){if(!this._watchTd){this._watchTd=true;zWatch.listen({onSize:[this,a],onHide:[this,a]})}},_unbindFixTd:function(){if(this._watchTd){zWatch.unlisten({onSize:[this,a],onHide:[this,a]});delete this._watchTd}},_configPack:function(){var e=this._pack;if(e){var e=e.split(",");if(e[0].trim()=="stretch"){this._stretchPack=true;this._pack2=e.length>1?e[1].trim():null}else{this._stretchPack=e.length>1&&e[1].trim()=="stretch";this._pack2=e[0].trim()}}else{delete this._pack2;delete this._stretchPack}},onSize:_zkf=function(){if(!this._splitterKid){return}var h=this.isVertical(),e=this.$n(),m=this.$n("real");m.style.height=m.style.width="100%";var f=h?m.rows:m.rows[0].cells,l=h?zk(m).revisedHeight(m.offsetHeight):zk(m).revisedWidth(m.offsetWidth);for(var g=f.length;g--;){var j=f[g];if(zk(j).isVisible()){if(h){var n=j.offsetHeight;if(j.id&&!j.id.endsWith("-chdex2")){if(j.cells.length){var k=j.cells[0];k.style.height=zk(k).revisedHeight(g?n:l)+"px";j.style.height=""}else{j.style.height=zk(j).revisedHeight(g?n:l)+"px"}}l-=n}else{var n=j.offsetWidth;if(j.id&&!j.id.endsWith("-chdex2")){j.style.width=zk(j).revisedWidth(g?n:l)+"px"}l-=n}}}},onHide:_zkf},{_toValign:function(e){return e?"start"==e?"top":"center"==e?"middle":"end"==e?"bottom":e:null},_toHalign:function(e){return e?"start"==e?"left":"end"==e?"right":e:null}})})();